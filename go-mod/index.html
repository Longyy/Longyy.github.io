<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Go mod原理一次讲透 - 破折号</title><meta name="Description" content="破折号--记录成长点滴，成为更好的自已"><meta property="og:title" content="Go mod原理一次讲透" />
<meta property="og:description" content="1.前言 说起项目依赖管理工具大家一点都不陌生，像Java的Maven、Python的Pip、Php的Composer、Nodejs的Npm这" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.51set.cn/go-mod/" />
<meta property="article:published_time" content="2020-12-21T17:44:26+08:00" />
<meta property="article:modified_time" content="2020-12-21T17:44:26+08:00" /><meta property="og:site_name" content="破折号" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Go mod原理一次讲透"/>
<meta name="twitter:description" content="1.前言 说起项目依赖管理工具大家一点都不陌生，像Java的Maven、Python的Pip、Php的Composer、Nodejs的Npm这"/>
<meta name="application-name" content="破折号">
<meta name="apple-mobile-web-app-title" content="破折号"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://www.51set.cn/go-mod/" /><link rel="prev" href="http://www.51set.cn/rootfs/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.276e0f03323c1a097f41bcf92a0e23bc16079b9e1aae801b101c8fb90aa496875892c3263fbd90b62de11a4f7df38d3d.css" integrity="sha384-J24PAzI8Ggl/Qbz5Kg4jvBYHm54aroAbEByPuQqklodYksMmP72Qti3hGk998409"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Go mod原理一次讲透",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/www.51set.cn\/go-mod\/"
        },"genre": "posts","wordcount":  5588 ,
        "url": "http:\/\/www.51set.cn\/go-mod\/","datePublished": "2020-12-21T17:44:26+08:00","dateModified": "2020-12-21T17:44:26+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Little Dragon"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="破折号"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/logo.png"
        data-srcset="/logo.png, /logo.png 1.5x, /logo.png 2x"
        data-sizes="auto"
        alt="/logo.png"
        title="/logo.png" /><span class="header-title-post"> </span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/"> 最新 </a><a class="menu-item" href="/categories/go%E7%B3%BB%E5%88%97/"> Go系列 </a><a class="menu-item" href="/categories/kubernetes%E7%B3%BB%E5%88%97/"> Kubernetes系列 </a><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="破折号"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/logo.png"
        data-srcset="/logo.png, /logo.png 1.5x, /logo.png 2x"
        data-sizes="auto"
        alt="/logo.png"
        title="/logo.png" /><span class="header-title-post"> </span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/" title="">最新</a><a class="menu-item" href="/categories/go%E7%B3%BB%E5%88%97/" title="">Go系列</a><a class="menu-item" href="/categories/kubernetes%E7%B3%BB%E5%88%97/" title="">Kubernetes系列</a><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Go mod原理一次讲透</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="http://www.51set.cn" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Little Dragon</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/go%E7%B3%BB%E5%88%97/"><i class="far fa-folder fa-fw"></i>Go系列</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020/12/21">2020/12/21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 5588 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 12 分钟&nbsp;<span id="/go-mod/" class="leancloud_visitors" data-flag-title="Go mod原理一次讲透">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1前言">1.前言</a></li>
    <li><a href="#2go依赖管理工具发展">2.Go依赖管理工具发展</a></li>
    <li><a href="#3各个工具主要特点对比">3.各个工具主要特点对比</a></li>
    <li><a href="#4使用go-mod">4.使用go mod</a>
      <ul>
        <li><a href="#41设置环境变量">4.1.设置环境变量</a></li>
        <li><a href="#42初始化项目">4.2.初始化项目</a></li>
        <li><a href="#43增加依赖">4.3.增加依赖</a></li>
        <li><a href="#44升级依赖">4.4.升级依赖</a></li>
        <li><a href="#45gomod文件的四个关键字">4.5.go.mod文件的四个关键字</a></li>
        <li><a href="#46创建全新的module推送至github并使用">4.6.创建全新的module推送至github并使用</a></li>
        <li><a href="#47为firstgomod添加版本控制">4.7.为firstgomod添加版本控制</a></li>
        <li><a href="#48给module添加打patch">4.8.给Module添加打patch</a></li>
        <li><a href="#49给module更新次要版本">4.9.给Module更新次要版本</a></li>
        <li><a href="#410给module更新主版本">4.10.给Module更新主版本</a></li>
      </ul>
    </li>
    <li><a href="#5go-mod如何保证项目依赖的稳定性">5.go mod如何保证项目依赖的稳定性</a>
      <ul>
        <li><a href="#51gosum">5.1.go.sum</a></li>
        <li><a href="#52gosumdb">5.2.GOSUMDB</a></li>
      </ul>
    </li>
    <li><a href="#6总结">6.总结</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="1前言">1.前言</h2>
<p>说起项目依赖管理工具大家一点都不陌生，像Java的Maven、Python的Pip、Php的Composer、Nodejs的Npm这些工具大家都耳熟能详。项目依赖管理工具是项目的基石之一，它的好坏往往深刻影响着项目开发运行的效率、稳定性、扩展性、安全性等重要指标。今天我们来聊一聊Golang的包管理工具Go mod.</p>
<p>在此之前，我们必须要熟悉两个重要的环境变量GOROOT与GOPATH.</p>
<p><code>GOROOT</code> 指示GO的安装位置，其中有GO的原生类库(SDK)，在编译GO时需要用到；</p>
<p><code>GOPATH</code> 指示项目代码和依赖包的位置；必须设置，但是可以随项目不同而重新设置；GOPATH下有三个目录：</p>
<ul>
<li>
<p><code>src</code> 存放项目代码或依赖包源码；</p>
</li>
<li>
<p><code>bin</code> 存放由<code>go install</code> 或 <code>go get</code> 编译产生的二进制文件，为方便执行，最好将<code>$GOPATH/bin</code> 加入PATH路径；</p>
</li>
<li>
<p><code>pkg</code> 存放预编译产生的文件用于加速编译过程，通常我们不需要关心这个目录，它由GO自动管理；</p>
<pre><code class="language-shell">$ echo $GOPATH
/Users/longyongyu/Development/go/workspace
$ tree ./pkg/darwin_amd64
pkg/darwin_amd64
└── github.com
    ├── gogo
    │   └── protobuf
    │       ├── gogoproto.a
    │       ├── jsonpb.a
    │       └── proto.a
    └── golang
        └── protobuf
            └── proto.a
 $ ls -l ./bin
 total 533296
-rwxr-xr-x  1 longyongyu  staff   8961980 10 21 11:59 db2struct
-rwxr-xr-x  1 longyongyu  staff  18795324  9  9 18:47 dlv
-rwxr-xr-x  1 longyongyu  staff   5871480  6 22  2020 goimports
-rwxr-xr-x  1 longyongyu  staff   6315432  6 22  2020 golint
$ tree -L 2 ./src
├── go.uber.org
│   ├── atomic
│   ├── multierr
│   └── zap
├── golang.org
│   └── x
├── google.golang.org
│   ├── genproto
│   ├── grpc
│   └── protobuf
</code></pre>
</li>
</ul>
<p>查看当前项目的GO环境变量可以用<code>go env</code></p>
<pre><code class="language-shell">$ go env
GO111MODULE=&quot;on&quot;
GOARCH=&quot;amd64&quot;
GOBIN=&quot;&quot;
GOCACHE=&quot;/Users/longyongyu/Library/Caches/go-build&quot;
GOENV=&quot;/Users/longyongyu/Library/Application Support/go/env&quot;
GOEXE=&quot;&quot;
GOFLAGS=&quot;&quot;
GOHOSTARCH=&quot;amd64&quot;
GOHOSTOS=&quot;darwin&quot;
GOINSECURE=&quot;&quot;
GONOPROXY=&quot;xxx&quot; //去掉了敏感信息
GONOSUMDB=&quot;yyy&quot; //去掉了敏感信息
GOOS=&quot;darwin&quot;
GOPATH=&quot;/Users/longyongyu/Development/go/workspace&quot;
GOPRIVATE=&quot;zzz&quot; //去掉了敏感信息
GOPROXY=&quot;https://goproxy.cn&quot;
GOROOT=&quot;/usr/local/go&quot;
GOSUMDB=&quot;sum.golang.org&quot;
GOTMPDIR=&quot;&quot;
GOTOOLDIR=&quot;/usr/local/go/pkg/tool/darwin_amd64&quot;
GCCGO=&quot;gccgo&quot;
AR=&quot;ar&quot;
CC=&quot;clang&quot;
CXX=&quot;clang++&quot;
CGO_ENABLED=&quot;1&quot;
GOMOD=&quot;/dev/null&quot;
CGO_CFLAGS=&quot;-g -O2&quot;
CGO_CPPFLAGS=&quot;&quot;
CGO_CXXFLAGS=&quot;-g -O2&quot;
CGO_FFLAGS=&quot;-g -O2&quot;
CGO_LDFLAGS=&quot;-g -O2&quot;
PKG_CONFIG=&quot;pkg-config&quot;
GOGCCFLAGS=&quot;-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0\
-fdebug-prefix-map=/var/folders/dg/b4mzy9tx1ln1y7bkblz5lvsc0000gn/T/go-build462069466=/tmp/go-build\
-gno-record-gcc-switches -fno-common&quot;
</code></pre>
<p>要更改GO环境变量可以用<code>go env -w</code> 命令，如：</p>
<pre><code class="language-shell">$ go env -w GOPROXY=test.com
</code></pre>
<h2 id="2go依赖管理工具发展">2.Go依赖管理工具发展</h2>
<p>Go的包管理工具几经调整，从最开始的gopath、govender到后来的go mod, 以致go mod成为自v1.13以后的事实标准，都反映出了大家对于一款好用的包管理工具的急切渴望。下面列出其主要工具的发展过程：</p>
<p><img src="/Users/longyongyu/Development/Blog/content/posts/Go/img/image-dev2.png" alt="image-20201222002754640" style="zoom:33%;" /></p>
<p>V1.5之前，使用原生的<code>gopath</code> 进行包管理，要求项目源码与依赖包必须位于$GOPATH/src目录下；最大的问题，不能进行依赖包的多版本管理；</p>
<p>V1.5, 引入<code>govendor</code> ，GO环境变量需设置<code>GO15VENDOREXPERIMENT=1</code> 在项目根目录下自动生成vendor目录并存放依赖包, GO在编译时会优先去vendor目录查询依赖；vendor对依赖包进行了分类：</p>
<table>
<thead>
<tr>
<th>状态</th>
<th>缩写</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>+local</td>
<td>l</td>
<td>本地包，即项目自身的包组织</td>
</tr>
<tr>
<td>+external</td>
<td>e</td>
<td>外部包，即被 $GOPATH 管理，但不在 vendor 目录下</td>
</tr>
<tr>
<td>+vendor</td>
<td>v</td>
<td>已被 govendor 管理，即在 vendor 目录下</td>
</tr>
<tr>
<td>+std</td>
<td>s</td>
<td>标准库中的包</td>
</tr>
<tr>
<td>+unused</td>
<td>u</td>
<td>未使用的包，即包在 vendor 目录下，但项目并没有用到</td>
</tr>
<tr>
<td>+missing</td>
<td>m</td>
<td>代码引用了依赖包，但该包并没有找到</td>
</tr>
<tr>
<td>+program</td>
<td>p</td>
<td>主程序包，意味着可以编译为执行文件</td>
</tr>
<tr>
<td>+outside</td>
<td></td>
<td>外部包和缺失的包</td>
</tr>
<tr>
<td>+all</td>
<td></td>
<td>所有的包</td>
</tr>
</tbody>
</table>
<p>v1.9, 引入<code>godep</code> , 在govendor的基础上，记录了依赖包的版本信息存放于项目根目录的Godep目录下，需要与vendor目录一起提交至代码库；godep常用命令：</p>
<ul>
<li><code>go get -u -v github.com/tools/godep</code> 安装godep；</li>
<li><code>go get github.com/globalsign/mgo</code> 下载并安装依赖包；</li>
<li><code>import github.com/globalsign/mgo</code> 引用依赖包；</li>
<li><code>godep go build main.go</code> 编译项目；</li>
<li><code>godep save</code> 更新Godeps/Godeps.json文件；</li>
<li><code>godep restore</code> 拉取Godeps/Godeps.json文件定义的依赖包至$GOPATH/src目录下；</li>
</ul>
<p><a href="https://github.com/kubernetes/kubernetes/tree/release-1.13" target="_blank" rel="noopener noreffer">Kubernetes</a>早期版本就是用godep管理依赖的。</p>
<p>v1.11, 社区推出了<code>go mod</code> 方案，目前已成为GO的主流包管理工具，且大部分GO项目已支持go mod. go mod具有几个特点：</p>
<ul>
<li>项目代码摆脱了对<code>$GOPATH/src</code> 目录的依赖，在此之外的任何目录都可以使用go mod;</li>
<li>Goproxy代理协议，可以使用代理拉取依赖；</li>
<li>go mod的Tag必须遵循<a href="https://semver.org/lang/zh-CN/" target="_blank" rel="noopener noreffer">语义化版本控制</a>, 如果没有则将忽略Tag, 转而根据commit时间与commit hash值生成一个临时的版本号；</li>
<li>模块缓存。同一Module版本的数据只缓存一份，所有其他模块共享，目前所有模块版本数据均缓存在$GOPATH/pkg/mod下，可以使用<code>go clean -modcache</code> 清理所有Module缓存</li>
</ul>
<h2 id="3各个工具主要特点对比">3.各个工具主要特点对比</h2>
<p>通常，一个好用的包管理工具应该具备下面几项能力</p>
<ul>
<li>依赖管理</li>
<li>依赖包版本控制</li>
<li>包管理平台</li>
<li>私有化部署</li>
<li>代码包复用</li>
<li>支持代理（众所周知的原因）</li>
</ul>
<table>
<thead>
<tr>
<th>工具</th>
<th>依赖管理</th>
<th>依赖包版本控制</th>
<th>包管理平台</th>
<th>私有化部署</th>
<th>代码包复用</th>
<th>支持代理</th>
</tr>
</thead>
<tbody>
<tr>
<td>gopath</td>
<td><strong>Y</strong></td>
<td>N</td>
<td>N</td>
<td>N</td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>govendor</td>
<td><strong>Y</strong></td>
<td><strong>Y</strong></td>
<td>N</td>
<td>N</td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>godep</td>
<td><strong>Y</strong></td>
<td><strong>Y</strong></td>
<td>N</td>
<td>N</td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>go mod</td>
<td><strong>Y</strong></td>
<td><strong>Y</strong></td>
<td><strong>Y</strong></td>
<td><strong>Y</strong></td>
<td><strong>Y</strong></td>
<td><strong>Y</strong></td>
</tr>
</tbody>
</table>
<h2 id="4使用go-mod">4.使用go mod</h2>
<h3 id="41设置环境变量">4.1.设置环境变量</h3>
<p>要使用go mod，go版本必须在v1.11及以上；然后设置必要的环境变量（小知识：使用命令<code>go help environment</code> 可以查看go支持的所有环境变量及其用法）</p>
<pre><code class="language-shell">$ go env -w GO111MODULE=on
$ go env -w GOPROXY=https://goproxy.cn,direct //使用七牛云的代理服务
$ go env -w GOPATH=/Users/longyongyu/Development/go/workspace
</code></pre>
<p><code>go env -w</code> 会把配置写到<code>go env GOENV</code> 所配置的文件中，在我的macOS系统是<code>/Users/longyongyu/Library/Application Support/go/env</code> 文件。</p>
<pre><code class="language-shell">$ cat /Users/longyongyu/Library/Application\ Support/go/env
GO111MODULE=on
GOPATH=/Users/longyongyu/Development/go/workspace
GOPROXY=https://goproxy.cn,direct
</code></pre>
<p>设置<code>GO111MODULE=on</code> 表示启用go mod， 此时<code>go get</code> <code> go build</code> <code>go run</code> 等命令将被go mod接管，并在运行这些命令的时候自动维护<code>go.mod</code> <code>go.sum</code> 文件。</p>
<p><code>goproxy</code> 用于设置依赖的代理服务。</p>
<h3 id="42初始化项目">4.2.初始化项目</h3>
<pre><code class="language-shell">$ mkdir gomod
$ cd gomod
$ go mod init gomod
go: creating new go.mod: module gomod
$ cat go.mod
module gomod

go 1.14
</code></pre>
<h3 id="43增加依赖">4.3.增加依赖</h3>
<p>我们使用<code>go get</code> 命令为新项目添加依赖<code>gin</code>:</p>
<pre><code class="language-shell">$ go get github.com/gin-gonic/gin
go: github.com/gin-gonic/gin upgrade =&gt; v1.6.3
$ cat go.mod
module gomod

go 1.14

require github.com/gin-gonic/gin v1.6.3

</code></pre>
<p>我们发现新加了一行<code>require github.com/gin-gonic/gin v1.6.3</code> ，其中v1.6.3 表示gin的版本，go get 拉取依赖的原则是：</p>
<ul>
<li>若指定了版本，则拉取指定版本代码；</li>
<li>若未指定版本，则拉取最新的release tag.</li>
<li>若无tag, 则拉取最新的commit.</li>
</ul>
<h3 id="44升级依赖">4.4.升级依赖</h3>
<p>go get 升级依赖的方法：</p>
<ul>
<li><code>go get -u xxx</code> 将升级到最新次要版本，或者修订版本（x.y.z中，x为主版本，y为次要版本，z为修订版本）</li>
<li><code>go get -u=patch xxx</code> 将升级到最新的修订版本</li>
<li><code>go get xxx@version</code> 将升级到指定的version</li>
</ul>
<p><code>go list -m -u all</code>列出可以升级的package</p>
<pre><code class="language-shell">$ go list -m -u all
gomod
github.com/davecgh/go-spew v1.1.1
github.com/gin-contrib/sse v0.1.0
github.com/gin-gonic/gin v1.6.3
github.com/go-playground/assert/v2 v2.0.1
github.com/go-playground/locales v0.13.0
github.com/go-playground/universal-translator v0.17.0
github.com/go-playground/validator/v10 v10.2.0 [v10.4.1]
github.com/golang/protobuf v1.3.3 [v1.4.3]
github.com/google/gofuzz v1.0.0 [v1.2.0]
github.com/json-iterator/go v1.1.9 [v1.1.10]
github.com/leodido/go-urn v1.2.0 [v1.2.1]
github.com/mattn/go-isatty v0.0.12
github.com/modern-go/concurrent v0.0.0-20180228061459-e0a39a4cb421 [v0.0.0-20180306012644-bacd9c7ef1dd]
github.com/modern-go/reflect2 v0.0.0-20180701023420-4b7aa43c6742 [v1.0.1]
github.com/pmezard/go-difflib v1.0.0
...
</code></pre>
<p><code>go get -u xxx</code> 升级指定package</p>
<p><code>go get -u </code> 升级所有package</p>
<h3 id="45gomod文件的四个关键字">4.5.go.mod文件的四个关键字</h3>
<ul>
<li><code>module</code> 指定包的名字</li>
<li><code>require</code> 指定具体依赖项</li>
<li><code>replace</code> 替换依赖项</li>
<li><code>exclude</code> 忽略依赖项</li>
</ul>
<p>module名用于<code>import</code> ,可以是名字形式也可以是路径形式（例：github.com/golang/crypto）,这样可避免命名冲突。</p>
<p>replace 用于替换无法直接拉取的依赖（国内朋友深有体会），该语句可以将依赖包用github上的库（或者本地私有库）进行替换。如</p>
<pre><code>replace (
    golang.org/x/crypto v0.0.0-20190313024323-a1f597ede03a =&gt; github.com/golang/crypto v0.0.0-20190313024323-a1f597ede03a
)
</code></pre>
<p>exclude用于忽略某些依赖的版本，比如有的依赖的版本有问题。</p>
<pre><code>exclude github.com/SermoDigital/jose v0.9.1
</code></pre>
<p>查看一个完整的示例</p>
<pre><code>module github.com/example/project

require (
    github.com/SermoDigital/jose v0.0.0-20180104203859-803625baeddc
    github.com/google/uuid v1.1.0
)

exclude github.com/SermoDigital/jose v0.9.1

replace github.com/google/uuid v1.1.0 =&gt; git.coolaj86.com/coolaj86/uuid.go v1.1.1
</code></pre>
<h3 id="46创建全新的module推送至github并使用">4.6.创建全新的module推送至github并使用</h3>
<p>这里我们演示如何创建和提交一个新的module, 然后做为本地项目的依赖项使用。</p>
<pre><code class="language-shell">$ mkdir firstgomod
$ cd firstgomod
$ go mod init github.com/Longyy/firstgomod
go: creating new go.mod: module github.com/Longyy/firstgomod
$ touch util.go
</code></pre>
<p>我们在<code>util.go</code> 中实现两个方法，用来比较两个整数的大小</p>
<pre><code class="language-go">package firstgomod

func Max(x, y int) bool {
	return x &gt; y
}
func Min(x, y int) bool {
	return x &lt; y
}
</code></pre>
<p>看一下go.mod的内容</p>
<pre><code>module github.com/Longyy/firstgomod

go 1.14
</code></pre>
<p>继续在firstgomod目录下执行命令提交<code>firstgomod</code> 到github</p>
<pre><code class="language-shell">$ git init
$ touch .gitignore
$ echo '.idea/' &gt;&gt; .gitignore # 我IDE用的goland，.idea信息应该加入.gitignore
$ touch README.md
$ echo '# firstgomod' &gt;&gt; README.md
$ git add .
$ git commit -m 'my first go module'
$ git remote add origin git@github.com:Longyy/firstgomod.git
$ git branch -M main # github已推荐将主分支设置为main(而非master)
# 先在远端先创建firstgomod项目...，然后将本地代码推送至远端
$ git push origin main
</code></pre>
<p>一个全新的module制作完成，下面我们回到gomod项目来使用它</p>
<pre><code class="language-shell">$ cd gomod
$ go get github.com/Longyy/firstgomod
go: downloading github.com/Longyy/firstgomod v0.0.0-20201226041745-5ea883bf90c4
go: github.com/Longyy/firstgomod upgrade =&gt; v0.0.0-20201226041745-5ea883bf90c4
</code></pre>
<p>上面提到，在没有明确指定依赖版本的情况下，go mod会拉取最新release tag, 若没有tag, 则拉取最新的commit生成一个自定义的版本号，当前firgomod就是这种情况（v0.0.0-20201226041745-5ea883bf90c4），版本号分三段：&ldquo;默认版本号-最新Commit提交时间-最新CommitID). 我们要尽量避免使用这样的依赖，因为它实际上并没有进行版本控制，依赖是不稳定的。</p>
<p>在gomod/main.go文件中使用</p>
<pre><code class="language-go">package main

import (
	`fmt`

	`github.com/Longyy/firstgomod`
	`github.com/gin-gonic/gin`
)

func main() {
	// 使用firstgomod
	fmt.Println(&quot;max value is:&quot;, firstgomod.Max(1 ,2))

	r := gin.Default()
	r.GET(&quot;/test&quot;, func(context *gin.Context) {
		context.JSON(200, gin.H{
			&quot;msg&quot;: &quot;ok&quot;,
		})
	})
	_ = r.Run(&quot;:8080&quot;)
}
</code></pre>
<h3 id="47为firstgomod添加版本控制">4.7.为firstgomod添加版本控制</h3>
<p>打新的Release Tag</p>
<pre><code class="language-shell">$ cd /path/to/firstgomod
$ git tag v1.0.0
$ git push --tags
Total 0 (delta 0), reused 0 (delta 0)
To github.com:Longyy/firstgomod.git
 * [new tag]         v1.0.0 -&gt; v1.0.0
</code></pre>
<p>更新依赖</p>
<pre><code class="language-shell">$ go get -u github.com/Longyy/firstgomod
go: github.com/Longyy/firstgomod upgrade =&gt; v1.0.0
go: downloading github.com/Longyy/firstgomod v1.0.0
</code></pre>
<p>查看go.mod</p>
<pre><code class="language-mod">module gomod

go 1.14

require (
	github.com/Longyy/firstgomod v1.0.0
	github.com/gin-gonic/gin v1.6.3
)
</code></pre>
<p>看到firstgomod已经更新到最新的Tag v1.0.0</p>
<blockquote>
<p>当我们自己在维护module的时候要注意使用语义化版本控制规范，在打补丁(patch)或升级的时候要从具体Tag上切分支，而不是main(或master), 这样才利于保证版本的向后兼容性。</p>
</blockquote>
<h3 id="48给module添加打patch">4.8.给Module添加打patch</h3>
<p>接着我们来给Module打补丁: 给函数添加注释</p>
<pre><code class="language-shell">$ git checkout v1.0.0
$ git checkout -b feature-v1
</code></pre>
<p>在util.go中添加注释</p>
<pre><code class="language-go">package firstgomod

//计算整数较大值
func Max(x, y int) bool {
	return x &gt; y
}
//计算整数较小值
func Min(x, y int) bool {
	return x &lt; y
}
</code></pre>
<p>提交patch到github</p>
<pre><code class="language-shell">$ git commit -am 'add func comment'
$ git push -u origin feature-v1
$ git tag v1.0.1
$ git push --tags
</code></pre>
<p>更新gomod依赖</p>
<pre><code class="language-shell">$ go get -u github.com/Longyy/firstgomod
go: github.com/Longyy/firstgomod upgrade =&gt; v1.0.1
go: downloading github.com/Longyy/firstgomod v1.0.1
</code></pre>
<p>看到依赖已经更新。</p>
<h3 id="49给module更新次要版本">4.9.给Module更新次要版本</h3>
<p>更新次要版本不应该影响module的向后兼容性，我们给firstgomod添加新函数Avg：</p>
<pre><code class="language-go">package firstgomod

//计算整数较大值
func Max(x, y int) bool {
	return x &gt; y
}
//计算整数较小值
func Min(x, y int) bool {
	return x &lt; y
}
//计算平均值
func Avg(x, y float32) float32 {
	return (x + y) / 2
}
</code></pre>
<p>打tag并提交到github</p>
<pre><code class="language-shell">$ git commit -am 'add Avg func'
$ git push
$ git tag v1.1.1
$ git push --tags
</code></pre>
<p>使用最新版</p>
<pre><code class="language-shell">$ go get -u github.com/Longyy/firstgomod
go: github.com/Longyy/firstgomod upgrade =&gt; v1.1.1
go: downloading github.com/Longyy/firstgomod v1.1.1
</code></pre>
<h3 id="410给module更新主版本">4.10.给Module更新主版本</h3>
<p>主版本更新可以不保证向后兼容性(同一项目的不同主版本可以认为是各自相互独立的项目)，这里我们给三个函数重命名来达到目的</p>
<pre><code>package firstgomod/v2

//计算整数较大值
func IsMax(x, y int) bool {
	return x &gt; y
}
//计算整数较小值
func IsMin(x, y int) bool {
	return x &lt; y
}
//计算平均值
func GetAvg(x, y float32) float32 {
	return (x + y) / 2
}
</code></pre>
<p>同时为表示区分，我们将firstgomod的的module名字改为<code>github.com/Longyy/firstgomod/v2</code></p>
<pre><code class="language-mod">module github.com/Longyy/firstgomod/v2

go 1.14
</code></pre>
<p>打主版本Tag</p>
<pre><code class="language-shell">$ git commit -am 'add v2'
$ git push
$ git tag v2.0.0
$ git push --tags
</code></pre>
<p>在gomod项目中使用新的主版本v2.0.0</p>
<pre><code class="language-shell">$ go get -u github.com/Longyy/firstgomod
</code></pre>
<p>这里发现依赖并没有更新，原因就是<code>go get -u</code> 不会去更新依赖的主版本号，必须要手动指定</p>
<pre><code class="language-shell">$ go get github.com/Longyy/firstgomod@v2.0.0
go get github.com/Longyy/firstgomod@v2.0.0: github.com/Longyy/firstgomod@v2.0.0: invalid version: module contains a go.mod file, so major version must be compatible: should be v0 or v1, not v2
</code></pre>
<p>这时依赖还是不能更新，错误信息告诉我们在现有go.mod依赖下，主版本号必须是v0 或 v1。</p>
<p>我们需要在项目中import这个新版本的依赖，并且在代码中使用</p>
<pre><code class="language-mod">import (
	`fmt`
	`github.com/Longyy/firstgomod/v2`
	`github.com/gin-gonic/gin`
)

func main() {
	// 使用firstgomod
	fmt.Println(&quot;avg value is:&quot;, firstgomod.GetAvg(1 ,2))

	r := gin.Default()
	r.GET(&quot;/test&quot;, func(context *gin.Context) {
		context.JSON(200, gin.H{
			&quot;msg&quot;: &quot;ok&quot;,
		})
	})
	_ = r.Run(&quot;:8080&quot;)
}
</code></pre>
<p>然后运行<code>go mod tidy</code> ,可以看见新的版本被拉下来了</p>
<pre><code class="language-mod">
go 1.14

require (
	github.com/Longyy/firstgomod/v2 v2.0.0
	github.com/gin-gonic/gin v1.6.3
	github.com/go-playground/validator/v10 v10.4.1 // indirect
	github.com/golang/protobuf v1.4.3 // indirect
	github.com/json-iterator/go v1.1.10 // indirect
	github.com/leodido/go-urn v1.2.1 // indirect
	github.com/modern-go/concurrent v0.0.0-20180306012644-bacd9c7ef1dd // indirect
	github.com/modern-go/reflect2 v1.0.1 // indirect
	github.com/ugorji/go v1.2.2 // indirect
	golang.org/x/crypto v0.0.0-20201221181555-eec23a3978ad // indirect
	golang.org/x/sys v0.0.0-20201231184435-2d18734c6014 // indirect
	google.golang.org/protobuf v1.25.0 // indirect
	gopkg.in/yaml.v2 v2.4.0 // indirect
</code></pre>
<p>当然，一个项目的新老版本是可以同时使用的，只要在import时使用别名就好了</p>
<pre><code class="language-go">package main

import (
	`fmt`
	`github.com/Longyy/firstgomod`
	firstgomodv2 `github.com/Longyy/firstgomod/v2`
	`github.com/gin-gonic/gin`
)

func main() {
	// 使用firstgomod
	fmt.Println(&quot;avg value is:&quot;, firstgomodv2.GetAvg(1 ,2))
	fmt.Println(&quot;Avg value is:&quot;, firstgomod.Avg(1 ,2))
  // ...
}
</code></pre>
<h2 id="5go-mod如何保证项目依赖的稳定性">5.go mod如何保证项目依赖的稳定性</h2>
<p>go.mod文件记录项目所有依赖项目及其版本信息，可有没有想过，我们依赖的这些库如果被篡改了怎么办？或者依赖库的作者删除了我们正在依赖的某些版本怎么办？</p>
<p>实际上, go mod使用了分布式的依赖检验方式，没有统一的依赖镜像中心，每一个项目都维护一份本地的依赖信息，是不是有点“区块链”的味道~</p>
<h3 id="51gosum">5.1.go.sum</h3>
<p>这里go mod引入了go.sum文件协同go.mod文件进行依赖管理。</p>
<p>go.sum的作用类似于“借条”，里边详细记录了每一笔“借款”帐目：向谁借的，借的什么，落款签名。其结构如下：</p>
<pre><code class="language-txt">&lt;module&gt; &lt;version&gt;[/go.mod] &lt;hash&gt;
</code></pre>
<p>每行记录由module名、版本、哈希值组成。这里分两种情况：</p>
<ul>
<li>如果所依赖的版本使用了go mod, 则module名就是go.mod中的<code>module</code>字段</li>
<li>如果没有使用go mod, 则module名就是项目路径</li>
</ul>
<p>比如：</p>
<pre><code>//使用了go mod
github.com/go-playground/validator/v10 v10.4.1 h1:pH2c5ADXtd66mxoE0Zm9SUhxE20r7aM3F26W0hOn+GE=
//未使用go mod
github.com/modern-go/concurrent v0.0.0-20180306012644-bacd9c7ef1dd h1:TRLaZ9cD/w8PVh93nsPXa1VrQ6jlwL5oN8l14QlcNfg=
</code></pre>
<p>同时，还会为每个依赖版本库生成一行go.mod文件的检验值</p>
<pre><code>github.com/gin-gonic/gin v1.6.3/go.mod h1:75u5sXoLsGZoRN5Sgbi1eraJ4GU3++wFwWzhwvtwp4M=
</code></pre>
<p>这个值主要是用在生成依赖树的时候，不必将所有的依赖库代码都拉下来，只用go.mod就行了。</p>
<p>如何生成依赖树呢，使用<code>go mod why xxx(module name)</code> 命令即可：</p>
<pre><code class="language-shell">$ go mod why github.com/go-playground/validator/v10
# github.com/go-playground/validator/v10
gomod
github.com/gin-gonic/gin
github.com/gin-gonic/gin/binding
github.com/go-playground/validator/v10
</code></pre>
<p>Hash值前面都会跟一个&quot;h1:&ldquo;的前缀，表示使用的是hash算法的版本，目前只使用了一种hash算法：SHA-256.</p>
<p>go.mod只记录直接依赖与间接依赖（当依赖没有使用go mod时），go.sum会记录下每一笔版本信息.</p>
<p>当我们执行go get xxx命令时, go mod会将依赖下载到<code>$GOPATH/pkg/mod/cache/download</code> 指示的路径下，并生成v.x.y.x.zip的压缩包，同时生成该压缩包的hash值放入v.x.y.x.ziphash文件中，如果执行go get时目录中有go.mod文件，则在生成好hash值后，会同步更新go.mod和go.sum文件，将版本信息及hash值写入。</p>
<p>同时，为保证hash值真实可靠，go mod会向环境变量GOSUMDB指示的服务发起请求，检验该hash是否真实可靠。</p>
<h3 id="52gosumdb">5.2.GOSUMDB</h3>
<p>我们可以通过设置环境变量GOSUMDB指示一个校验数据库服务，提供查询依赖包版本<code>哈希值</code> 的服务，此时go get在拉取每一个依赖时，都会去查询该依赖的检验和是否合法，如果不合法go get 将中止执行。</p>
<p>GOSUMDB=off即关闭此服务，go get将跳开校验，相信所有依赖库。</p>
<p>Google官方的<code>sum.golang.org</code>记录了所有的可公开获得的<code>依赖包版本</code>。除了使用官方的数据库，还可以指定自行搭建的数据库。</p>
<h2 id="6总结">6.总结</h2>
<p>本文用较长的篇幅详细说明了go mod的前世今生，以及在使用中应该注意处理的细节、常用操作的罗列，希望大家在通读后能对go的依赖包管理机制有所了解，并在工作做到心中有数、灵活运用。</p>
<p>欢迎留言交流，谢谢。</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2020/12/21</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="http://www.51set.cn/go-mod/" data-title="Go mod原理一次讲透"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="http://www.51set.cn/go-mod/"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Linkedin" data-sharer="linkedin" data-url="http://www.51set.cn/go-mod/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="http://www.51set.cn/go-mod/" data-title="Go mod原理一次讲透" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="http://www.51set.cn/go-mod/" data-title="Go mod原理一次讲透"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="http://www.51set.cn/go-mod/" data-title="Go mod原理一次讲透"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/rootfs/" class="prev" rel="prev" title="容器镜像之RootFS解析"><i class="fas fa-angle-left fa-fw"></i>容器镜像之RootFS解析</a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="http://www.51set.cn" target="_blank">Little Dragon</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                    <span class="icp"><a rel="" href="http://beian.miit.gov.cn/" target="_blank">沪ICP备18028210号</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.8/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.8519327f8e0ddb51ffd37fa8972a891361693da1e7e29f7a793d3e25346fbe73335cc2ba01780a5a2cb4d3be7ada9fec.js" integrity="sha384-hRkyf44N21H/03&#43;olyqJE2FpPaHn4p96eT0&#43;JTRvvnMzXMK6AXgKWiy007562p/s"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.ae1e6ed811dfa9c546d5e8fc7998e50a35f9a9c7fd41e747ec51cefe4db5271d4e6e94d8b90c045ef2e5aab95bd37145.js" integrity="sha384-rh5u2BHfqcVG1ej8eZjlCjX5qcf9QedH7FHO/k21Jx1ObpTYuQwEXvLlqrlb03FF"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@13.0.0/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":100},"comment":{"valine":{"appId":"7pjS2EVnoM5ntmJccj7cQYi1-gzGzoHsz","appKey":"VwIeWbPTj4Jj8JScb83UT5ob","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":true,"highlight":true,"lang":"zh-cn","pageSize":10,"placeholder":"你的评论 ...","recordIP":false,"visitor":true}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":30,"type":"lunr"},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.f0e4096f68a24e87589ba7942f64874a24befc1ce05399522b0178ac9d3fb20b351b96e095dd6b5bfbe89cb6834a4b3a.js" integrity="sha384-8OQJb2iiTodYm6eUL2SHSiS&#43;/BzgU5lSKwF4rJ0/sgs1G5bgld1rW/vonLaDSks6"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', '257166355');
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=257166355" async></script></body>
</html>
